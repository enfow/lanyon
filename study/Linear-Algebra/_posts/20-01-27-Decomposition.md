---
layout: post
title: 4. Decomposition
category_num : 4
---

# Decomposition

- update date : 2020.01.27

12라는 수를 잘 이해하는 방법 중 하나는 소인수 분해를 통해 어떠한 소수의 곱으로 표현할 수 있는지 확인하는 것이다. 이렇게 하면 12는 2로는 나누어지지만 5로는 나누어지지 않는다는 것을 쉽게 확인할 수 있다. 이와같이 어떤 수학적 대상들을 특정한 성분들로 분해해서 보면 보다 쉽게 이해할 수 있다. 이는 행렬 또한 마찬가지인데, 행렬을 분해하는 가장 대표적인 방법으로는 **고유값 분해(Eigendecomposition)**와 **특이값 분해(Singular Value Decomposition)**가 있다.

## 1. Eigendecomposition

### 고유벡터와 고유값

어떤 행렬 $$A$$는 아래와 같이 벡터 $$v$$와 스칼라 값 $$\lambda$$로 분해할 수 있다.

$$
Av = \lambda v
$$

위의 식에서 $$A$$는 분해 대상이 되는 정방행렬이다. 그리고 $$v$$와 $$\lambda$$는 각각 0이 아닌 벡터와 스칼라 값으로, 이를 **고유벡터**(eigen vector)와 **고유값**(eigen value)이라고 한다. 식의 의미만 본다면 행렬 $$A$$에 의한 선형 변환의 결과($$Av$$)가 벡터 $$v$$의 방향은 보존하고 그 크기만 바꾼다는 것이 된다. 기존 벡터의 방향이 보존된다는 점에서 '고유'라는 표현이 붙고, 이때 고유값은 스케일이 얼마나 변화하는지를 나타내게 된다.

고유벡터의 방향은 동일하고 스케일은 $$\lambda$$에 의해 조절된다는 점에서 어떤 벡터 $$v$$가 행렬 $$A$$의 고유벡터라면 0이 아닌 실수 $$s$$가 곱해진 $$sv$$ 또한 고유벡터가 된다. 따라서 어떤 행렬의 고유벡터는 unit vector로 표현하는 것이 일반적이다.

여기서 한 가지 주의할 점 중 하나는 위에서 정방행렬의 조건을 가정하고 있듯이 모든 벡터가 고유값, 고유벡터를 가지지는 않는다는 것이다.

### 고유값 분해

어떤 행렬 $$A$$가 $$n$$개의 선형 독립의 고유벡터와 고유값을 가진다고 가정하자.

- Array : $$A$$
- eigenvector : $$\{v^{(1)}, v^{(2)}, ... v^{(n)} \}$$
- eigenvalue : $$\{\lambda^{(1)}, \lambda^{(2)}, ... \lambda^{(n)} \}$$

이때 각각의 eigenvector를 모두 합해 이들을 column vector로 갖는 행렬 $$V$$를 만들고, eigenvalue 또한 모두 합하여 vector $$\lambda$$로 만들면 아래와 같이 행렬 $$A$$를 표현할 수 있다.

$$
\eqalign{
&Av_1 = \lambda_1 v_1 \\
&Av_2 = \lambda_2 v_2 \\
&... \\
&Av_n = \lambda_n v_n \\
}
\qquad
\eqalign{
\Rightarrow \qquad &A[v_1, v_2, ..., v_n]\\
& \qquad = [\lambda_1 v_1, \lambda_2, v_2, ..., \lambda_n v_n]
}
$$

$$
\eqalign{
\qquad \qquad \qquad \qquad \ = \qquad [v_1, v_2, ...,v_n] 

\begin{bmatrix}
\lambda_1, 0, ..., \ 0 \\
0, \ \lambda_2, ..., 0 \\
...\\
\qquad \qquad \lambda_n \\
\end{bmatrix}

}
$$

위의 식은 $$AV = V diag(\lambda)$$ 로 표기할 수 있으며, 여기서 좌변의 V를 우변으로 넘기면 다음과 같다.

$$A = V diag(\lambda)V^{-1}$$

이와 같이 행렬 $$A$$를 분해하는 것을 **고유값 분해(eigendecomposition)**라고 하며, 이를 위해서는 정방행렬임과 동시에 행렬의 크기만큼 선형 독립의 고유 벡터를 구할 수 있어야 한다.

#### 대칭행렬과 고유값 분해

고유값 분해와 관련하여 중요한 성질 중 하나는 실수의 대칭 행렬(symmetric matrix, $$A = A^T$$)은 항상 고유값 분해가 가능하다는 점이다. 즉 대칭 행렬 $$A^{nXn}$$은 선형 독립의 $$n$$개 고유 벡터와 고유 값을 가진다. 이는 아래의 식과 같이 표현할 수 있다.

$$
A = Q \Lambda Q^T
$$

여기서 행렬 $$Q$$는 대칭행렬 $$A$$의 고유 벡터로 구성된 직교  행렬이며, $$\Lambda$$는 대칭 행렬이다. 이렇게 되면 $$\Lambda_{i,i}$$는 $$Q$$의 $$i$$번째 열백터의 고유값이 되는 셈이다.

이때 $$Q^T$$는 직교 행렬이기 때문에 $$AA^T = A^TA = I$$의 특성을 가지므로 다음과 같이 표현할 수 있다.

$$
A Q = Q \Lambda Q^T Q \\
\Rightarrow A Q = Q \Lambda I \\
\Rightarrow A Q = Q \Lambda\\
$$

결과적으로 대칭 행렬 $$A$$는 $$Q$$를 구성하는 열백터 $$v_i$$를 각각의 방향으로 $$\Lambda_i$$의 크기만큼 선형 변환하는 행렬이 된다.

일반적인 정방행렬에 대한 고유값 분해와 대칭행렬의 고유값 분해는 아래와 같이 나타낼 수 있다. 쉽게 생각하면 대칭행렬의 경우 역행렬과 전치행렬이 같으므로, 고유값 분해에서 역행렬로 표현되는 부분을 전치행렬로 표현한 것이다.

- 고유값 분해 : $$A = V \Lambda V^{-1}$$
- 대칭행렬의 고유값 분해 : $$A = Q \Lambda Q^T$$

#### 고유벡터와 고유값, 고유값 분해의 의미

어떤 벡터 $$x$$에 대해 행렬 $$A$$를 이용해 선형 변환을 가했다고 하자. 그런데 결과로 벡터 $$x$$에 회전 변환은 일어나지 않고 확대 축소 변환만 발생한 경우, 즉 방향은 기존과 동일한데 크기만 변화하는 경우를 생각해 볼 수 있다. 고유벡터와 고유값은 이와 같은 경우에서 행렬 $$A$$에 대한 벡터 $$x$$와 확대 축소 변환의 크기를 의미한다.

이러한 점을 고려해 볼 때 행렬 $$A$$의 고유벡터와 고유값을 구한다는 것은 행렬 $$A$$로 임의의 벡터에 선형 변환을 가할 때 어떠한 변화가 있을 지 예측하는 방법이 된다. 예를 들어 2차원 벡터에 대한 선형변환자 행렬 $$A$$의 고유벡터가 $$v_1, v_2$$, 고유값이 $$\lambda_1, \lambda_2$$라고 하면, $$A$$를 통한 선형변환의 결과는 $$v_1, v_2$$ 두 벡터를 기저로 하는 공간에서 각 축에 대해 $$\lambda_1, \lambda_2$$ 만큼 확대 축소 변환하는 것이 된다.

이러한 점에서 볼 때, 고유값 분해 식 $$A = V diag(\lambda)V^{-1}$$에서 $$V$$의 열백터들이 직교해야 한다는 것은 각각의 열백터를 기저로 하는 공간에 매핑하는 것과 관련있는 것으로 이해할 수 있다.

- 행렬 $$A$$의 고유벡터 = $$A$$로 선형변환을 실시할 때 기저가 되는 축, 일정하게 확대축소되는 축
- 어떤 고유벡터의 고유값 = 고유벡터를 따라 확대축소되는 크기

#### 고유값과 행렬의 분류

모든 에르미트 행렬의 고유값은 항상 실수이며, 그 값에 따라 다음과 같이 분류할 수 있다([wiki 참조](<https://ko.wikipedia.org/wiki/%EC%A0%95%EB%B6%80%ED%98%B8_%ED%96%89%EB%A0%AC#%EB%B9%84%28%E9%9D%9E%29%EC%97%90%EB%A5%B4%EB%AF%B8%ED%8A%B8_%ED%96%89%EB%A0%AC%EC%9D%98_%EA%B2%BD%EC%9A%B0>)).

- **양의 정부호 행렬**(positive definite) : 고유값이 모두 양수인 행렬
- **양의 준정부호 행렬**(positive semi-definite) : 고유값이 모두 양수 또는 0인 행렬
- **음의 정부호 행렬**(negative definite) : 고유값이 모두 음수인 행렬
- **음의 준정부호 행렬**(negative semi-definite) : 고유값이 모두 음수 또는 0인 행렬

### 행렬의 대각화

다음과 같은 관계가 성립할 때 행렬 $$A$$는 대각화가 가능하다(diagonalizable)고 한다. 즉, 행렬 $$Q$$가 행렬 $$A$$를 대각행렬 $$D$$로 표현할 수 있도록 해준다는 점에서 대각화한다고 말한다.

$$
A = Q D Q^{-1} \\
Q^{-1} A Q = D
$$

행렬 $$A$$에 대해 행렬 $$Q$$가 $$A$$의 고유 벡터를 열백터로 가지고, $$D$$가 각각의 고유벡터에 대응하는 고유값을 대각 성분으로 가진다면 행렬 $$Q$$는 행렬 $$A$$를 대각화한다고 할 수 있다. 그런데 위 식은 고유값 변환 식과 동일하게 생겼다. 즉, 정방행렬의 대각화는 고유값 분해를 의미한다고 할 수 있다.

이러한 행렬의 대각화 특성을 이용하면 행렬 $$A$$의 거듭제곱을 다음과 같이 쉽게 구할 수 있다.

$$
\eqalign{
A^n &= (Q D Q^{-1})^n \\
&= (Q D Q^{-1})(Q D Q^{-1}) ... (Q D Q^{-1})\\
&= Q D^n Q^{-1}
}
$$

고유값 분해는 정방행렬 등 특수한 조건이 만족할 때 행렬을 대각화하는 방법이다. 이와는 달리 직사각행렬에 대해서도 행렬의 대각화가 가능한데, 이를 특이값 분해(Singular Value Decomposition)라고 한다.

## 2. Singular Value Decomposition

### 특이값 분해

**특이값 분해(Singular Value Decomposition, SVD)**란 다음과 같이 행렬 $$A$$를 분해하는 것이라고 할 수 있다.

$$
A = UDV^T
$$

고유값 분해와 비교해 볼 때 특이값 분해의 가장 큰 특징 중 하나는 정방행렬, 직교행렬을 요구하지 않는다는 점이다. 즉 특이값 분해는 모든 실수 행렬($$\forall A^{m X n}$$)에 대해 적용이 가능하다.

위의 식에서 $$U^{mXm}$$는 $$AA^T$$를 고유값 분해하여 얻은 정방의 직교행렬을 의미한다. 그리고 $$V^{nXn}$$는 $$A^TA$$를 고유값 분해하여 얻은 정방의 직교행렬이다. $$AA^T, A^TA$$은 그 정의상 모두 대칭행렬이 되기 때문에 항상 고유값 분해가 가능하다 ($$\because AA^T = (AA^T)^T$$). 이러한 점에서 SVD는 모든 실수의 행렬에 대해 적용될 수 있다.

특이값 분해에서는 $$U$$의 직교하는 열백터들을 **left-singular vectors**라고 하고, $$V$$를 직교하는 열백터들을 **right-singular vectors**라고 한다. $$D$$는 **singular values**로서 주대각 성분이 $$\root \of \lambda_i $$로 이뤄진 직사각 대각행렬이 된다. 이때 각각의 $$\root \of \lambda_i $$를 **특이값(singular value)**이라고 한다.

### 특이값 분해와 고유값 분해의 관계

$$
\eqalign{
AA^T &= (UDV^T)(UDV^T)^T\\
&= (UDV^T)(VDU^T)\\
&= UDV^TVDU^T\\
&= UDDU^T
}
\qquad
\eqalign{
A^TA &= (UDV^T)^T(UDV^T)\\
&= (VDU^T)(UDV^T)\\
&= VDU^TUDV^T\\
&= VDDV^T\\
}
$$

이때 $$D$$는 고유값 $$\lambda_i$$에 루트를 씌운 $$\root \of \lambda_i $$를 대각성분으로 갖기 때문에 위의 식에서 $$D^TD, DD^T$$는 고유값 그 자체가 된다.

따라서 위의 두 식은 모두 고유값 분해와 같은 식이 되며, SVD를 계산하는 것은 $$A^TA, AA^T$$의 고유 벡터와 고유 값을 구하는 것과 동일하다고 할 수 있다.
